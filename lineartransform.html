<!DOCTYPE html>
<html>
<head>
<script>

function tograph(x,mn,mx) {
	var m = -500/(mn-mx);
	var b = 500*mn/(mn-mx);
	return(m*x+b);
	}

function tog(pt) {
	var mnx = document.getElementById("plotminx").value;
	var mxx = document.getElementById("plotmaxx").value;
	var mny = document.getElementById("plotminy").value;
	var mxy = document.getElementById("plotmaxy").value;
	return([tograph(pt[0],mnx,mxx),500-tograph(pt[1],mny,mxy)]);
	}

function arrowto(ctx,pt1,pt2,col) {
	ctx.lineWidth=4;
	ctx.strokeStyle=col;
	ctx.beginPath();
	var lg = Math.sqrt((pt1[0]-pt2[0])*(pt1[0]-pt2[0]) + (pt1[1]-pt2[1])*(pt1[1]-pt2[1]));
	var x = 5*(pt1[0]-pt2[0])/lg;
	var y = 5*(pt1[1]-pt2[1])/lg;
	ctx.moveTo(pt1[0],pt1[1]);
	ctx.lineTo(pt2[0]+x,pt2[1]+y);
	ctx.stroke();
	ctx.fillStyle=col;
	ctx.lineWidth=1;
	ctx.moveTo(pt2[0],pt2[1]);
	ctx.lineTo(pt2[0]+2*x+y,pt2[1]+2*y-x);
	ctx.lineTo(pt2[0]+2*x-y,pt2[1]+2*y+x);
	ctx.lineTo(pt2[0],pt2[1]);
	ctx.fill();
	}

function drawcanv(a,b,c,d) {
	var xmn = Number(document.getElementById("plotminx").value);
	var xmx = Number(document.getElementById("plotmaxx").value);
	var ymn = Number(document.getElementById("plotminy").value);
	var ymx = Number(document.getElementById("plotmaxy").value);
	var ctx = document.getElementById("canv").getContext("2d");
	var u = 10; //size of universe for purposes of transforming stuff.
	var k;
	ctx.lineWidth=1;
	ctx.beginPath();
	ctx.fillStyle = "#FFFFFF";
	ctx.fillRect(0,0,500,500);
	ctx.beginPath();
	if (document.getElementById("c2").checked) {
		ctx.strokeStyle="gray";
		for (k = Math.ceil(xmn); k < xmx; k++) {
			ctx.beginPath();
			ctx.moveTo(tograph(k,xmn,xmx),0);
			ctx.lineTo(tograph(k,xmn,xmx),500);
			ctx.stroke();
			}
		for (k = Math.ceil(ymn); k < ymx; k++) {
			ctx.beginPath();
			ctx.moveTo(0,500-tograph(k,ymn,ymx));
			ctx.lineTo(500,500-tograph(k,ymn,ymx));
			ctx.stroke();
			}
		ctx.strokeStyle = "black";
		}
	if (document.getElementById("c1").checked) {
		ctx.strokeStyle = "black";
		ctx.beginPath();
		ctx.moveTo(0,500-tograph(0,ymn,ymx));
		ctx.lineTo(500,500-tograph(0,ymn,ymx));
		ctx.stroke();
		ctx.beginPath();
		ctx.moveTo(tograph(0,xmn,xmx),0);
		ctx.lineTo(tograph(0,xmn,xmx),500);
		ctx.stroke();
		}
	if (document.getElementById("c3").checked) {
		ctx.strokeStyle="blue";
		ctx.beginPath();
		ctx.moveTo(tog([-(u*a),-(u*c)])[0],tog([-(u*a),-(u*c)])[1]);
		ctx.lineTo(tog([u*a,u*c])[0],tog([u*a,u*c])[1]);
		ctx.stroke();
		ctx.strokeStyle="red";
		ctx.beginPath();
		ctx.moveTo(tog([-(u*b),-(u*d)])[0],tog([-(u*b),-(u*d)])[1]);
		ctx.lineTo(tog([u*b,u*d])[0],tog([u*b,u*d])[1]);
		ctx.stroke();
		}
	if (document.getElementById("c4").checked) {
		ctx.strokeStyle="blue";
		for (k = -u; k <= u; k++) {
			ctx.beginPath();
			ctx.moveTo(tog([-(u*a)+k*b,-(u*c)+k*d])[0],tog([-(u*a)+k*b,-(u*c)+k*d])[1]);
			ctx.lineTo(tog([u*a+k*b,u*c+k*d])[0],tog([u*a+k*b,u*c+k*d])[1]);
			ctx.stroke();
			}
		ctx.strokeStyle="red";
		for (k = -u; k <= u; k++) {
			ctx.beginPath();
			ctx.moveTo(tog([-(u*b)+k*a,-(u*d)+k*c])[0],tog([-(u*b)+k*a,-(u*d)+k*c])[1]);
			ctx.lineTo(tog([u*b+k*a,u*d+k*c])[0],tog([u*b+k*a,u*d+k*c])[1]);
			ctx.stroke();
			}
		}
	if (document.getElementById("c6").checked) {
		var img = document.getElementById("sheep");
		var px = tog([b,d])[0];
		var py = tog([b,d])[1];
		var qx = tog([a+b,c+d])[0];
		var qy = tog([a+b,c+d])[1];
		var rx = tog([0,0])[0];
		var ry = tog([0,0])[1];
		ctx.transform(qx-px,qy-py,rx-px,ry-py,px,py);
		ctx.drawImage(img,0,0,1,1);
		ctx.setTransform(1,0,0,1,0,0);
		}
	if (document.getElementById("c5").checked) {
		ctx.fillStyle = 'rgba(0,255,0,.5)';
		ctx.beginPath();
		ctx.moveTo(tog([0,0])[0],tog([0,0])[1]);
		ctx.lineTo(tog([a,c])[0],tog([a,c])[1]);
		ctx.lineTo(tog([a+b,c+d])[0],tog([a+b,c+d])[1]);
		ctx.lineTo(tog([b,d])[0],tog([b,d])[1]);
		ctx.fill();
		}
	arrowto(ctx,tog([0,0]),tog([a,c]),"blue");
	arrowto(ctx,tog([0,0]),tog([b,d]),"red");
	if (document.getElementById("c7").checked) {
		arrowto(ctx,tog([0,0]),tog([veca*a+vecb*b,veca*c+vecb*d]),"black");
		}
	}

function Upd() {
	var a = Number(document.getElementById("a").value);
	var b = Number(document.getElementById("b").value);
	var c = Number(document.getElementById("c").value);
	var d = Number(document.getElementById("d").value);
	if (document.getElementById("c7").checked) {
		document.getElementById("w3").innerHTML = makematrix(veca*a+vecb*b,"",veca*c+vecb*d,"");
		}
	drawcanv(a,b,c,d);
	}

var tim=0;
function mm() {
	var a = Number(document.getElementById("a").value);
	var b = Number(document.getElementById("b").value);
	var c = Number(document.getElementById("c").value);
	var d = Number(document.getElementById("d").value);
	tim += .01;
	drawcanv(a*tim+1-tim,b*tim,c*tim,d*tim+1-tim);
	}

function morph() {
	var a = Number(document.getElementById("a").value);
	var b = Number(document.getElementById("b").value);
	var c = Number(document.getElementById("c").value);
	var d = Number(document.getElementById("d").value);
	var i = 0;
	tim=0;
	drawcanv(1,0,0,1);
	for(i = 0; i < 100; i++) {
		setTimeout(mm,10*i+100);
		}
	}

function makematrix(a,b,c,d) {
	var rstr = "";
	rstr += "<table border = 0> <tr> <td rowspan=2 style='border-left:1px solid; border-top:1px solid; border-bottom:1px solid'> </td> <td>";
	rstr += a;
	rstr += "</td> <td>";
	rstr += b;
	rstr += "</td> <td rowspan=2 style='border-right:1px solid; border-top:1px solid; border-bottom:1px solid'> </td> </tr>";
	rstr += "<tr> <td>";
	rstr += c;
	rstr += "</td> <td>";
	rstr += d;
	rstr += "</td> </tr> </table>";
	return(rstr);
	}

function nb(id, def) {
	var rstr = "";
	rstr += "<input type ='number' id='";
	rstr += id;
	rstr += "' value='";
	rstr += def;
	rstr += "' oninput='updt(\"" + id + "\")' style='width:2em'>";
	return(rstr);
	}

function nb3(id) {
	var def = 90;
	var rstr = "";
	rstr += "<input type ='number' id='";
	rstr += id;
	rstr += "' value='";
	rstr += def;
	rstr += "' oninput='updt(\"" + id + "\")' style='width:3em' step=5>";
	return(rstr);
	}

function updt(id) {
	var a = Number(document.getElementById("a").value);
	var b = Number(document.getElementById("b").value);
	var c = Number(document.getElementById("c").value);
	var d = Number(document.getElementById("d").value);
	if (id == "k1") {
		document.getElementById("a").value = 1;
		document.getElementById("b").value = document.getElementById("k1").value;
		document.getElementById("c").value = 0;
		document.getElementById("d").value = 1;
		}
	else if (id == "k2") {
		document.getElementById("a").value = 1;
		document.getElementById("b").value = 0;
		document.getElementById("c").value = document.getElementById("k2").value;
		document.getElementById("d").value = 1;
		}
	else if (id == "k3") {
		document.getElementById("a").value = document.getElementById("k3").value;
		document.getElementById("b").value = 0;
		document.getElementById("c").value = 0;
		document.getElementById("d").value = 1;
		}
	else if (id == "k4") {
		document.getElementById("a").value = 1;
		document.getElementById("b").value = 0;
		document.getElementById("c").value = 0;
		document.getElementById("d").value = document.getElementById("k4").value;
		}
	else if (id == "k5") {
		document.getElementById("l5").value = document.getElementById("k5").value;
		document.getElementById("a").value = document.getElementById("k5").value;
		document.getElementById("b").value = 0;
		document.getElementById("c").value = 0;
		document.getElementById("d").value = document.getElementById("k5").value;
		}
	else if (id == "l5") {
		document.getElementById("k5").value = document.getElementById("l5").value;
		document.getElementById("a").value = document.getElementById("k5").value;
		document.getElementById("b").value = 0;
		document.getElementById("c").value = 0;
		document.getElementById("d").value = document.getElementById("k5").value;
		}
	else if (id =="r1" || id == "r2" || id == "r3" || id == "r4" || id == "r5") {
		var ang = document.getElementById(id).value;
		document.getElementById("r1").value = ang;
		document.getElementById("r2").value = ang;
		document.getElementById("r3").value = ang;
		document.getElementById("r4").value = ang;
		document.getElementById("r5").value = ang;
		var conv = 2 * Math.PI/360;
		document.getElementById("a").value = Math.cos(ang*conv).toFixed(3);
		document.getElementById("b").value = (-Math.sin(ang*conv)).toFixed(3);
		document.getElementById("c").value = Math.sin(ang*conv).toFixed(3);
		document.getElementById("d").value = Math.cos(ang*conv).toFixed(3);
		}
	else if (id == "v1" || id == "v2") {
		veca = document.getElementById("v1").value;
		vecb = document.getElementById("v2").value;
		document.getElementById("w3").innerHTML = makematrix(veca*a+vecb*b,"",veca*c+vecb*d,"");
		}
	Upd();
	}

function updf() {
	var t = document.getElementById("self").value;
	var matvals = [[1,0,0,-1],[-1,0,0,1],[0,1,1,0],[0,-1,-1,0]];
	document.getElementById("f1").innerHTML = matvals[t][0];
	document.getElementById("f2").innerHTML = matvals[t][1];
	document.getElementById("f3").innerHTML = matvals[t][2];
	document.getElementById("f4").innerHTML = matvals[t][3];
	document.getElementById("a").value = matvals[t][0];
	document.getElementById("b").value = matvals[t][1];
	document.getElementById("c").value = matvals[t][2];
	document.getElementById("d").value = matvals[t][3];
	Upd();
	}

function mb(i,t) {
	var rstr = "";
	rstr += "<button onclick='butt("+i+")'>";
	rstr += t;
	rstr += "</button>";
	return(rstr);
	}

function butt(i) {
	var a = 0;
	var b = 0;
	var c = 0;
	var d = 0;
	if (i == 0) {
		a = 1;
		b = 0;
		c = 0;
		d = 1;
		}
	else if (i == 1) {
		a = 1;
		b = document.getElementById("k1").value;
		c = 0;
		d = 1;
		}
	else if (i == 2) {
		a = 1;
		b = 0;
		c = document.getElementById("k2").value;
		d = 1;
		}
	else if (i == 3) {
		a = document.getElementById("k3").value;
		b = 0;
		c = 0;
		d = 1;
		}
	else if (i == 4) {
		a = 1;
		b = 0;
		c = 0;
		d = document.getElementById("k4").value;
		}
	else if (i == 5) {
		a = document.getElementById("k5").value;
		b = 0;
		c = 0;
		d = document.getElementById("k5").value;
		}
	else if (i == 6) {
		updf();
		return;
		}
	else if (i == 7) {
		updt("r1");
		return;
		}
	document.getElementById("a").value = a;
	document.getElementById("b").value = b;
	document.getElementById("c").value = c;
	document.getElementById("d").value = d;
	Upd();
	}

function maketemplates() {
	var str = "";
	str += "<table border = 1>";
	str += "<tr> <td>" + mb(0,"Identity");
	str += "</td> <td>" + mb(1,"H. Shear"); 
	str += "</td> <td>" + mb(2,"V. Shear");
	str += "</td> <td>" + mb(3,"H. Stretch");
	str += "</td> <td>" + mb(4,"V. Stretch");
	str += "</td> <td>" + mb(5,"Scale");
	str += "</td> <td>" + mb(6,"Reflect") + "over";
	str += "<select oninput='updf()' id='self'>";
	str += "<option value=0> x-axis </option>";
	str += "<option value=1> y-axis </option>";
	str += "<option value=2> y = x </option>";
	str += "<option value=3> y = -x </option>";
	str += "</select>";
	str += "</td> <td>" + mb(7,"Rotate");
	str += nb3("r1");
	str += "degrees </td> </tr>";
	str += "<tr> <td>";
	str += makematrix(1,0,0,1);
	str += "</td> <td>";
	str += makematrix(1,nb("k1",1),0,1);
	str += "</td> <td>";
	str += makematrix(1,0,nb("k2",1),1);
	str += "</td> <td>";
	str += makematrix(nb("k3",2),0,0,1);
	str += "</td> <td>";
	str += makematrix(1,0,0,nb("k4",2));
	str += "</td> <td>";
	str += makematrix(nb("k5",2),0,0,nb("l5",2));
	str += "</td> <td>";
	str += makematrix("<div id='f1'>1</div>","<div id='f2'>0</div>","<div id='f3'>0</div>","<div id='f4'>-1</div>");
	str += "</td> <td>";
	str += makematrix("cos" + nb3("r2"),"-sin" + nb3("r3"),"sin"+nb3("r4"),"cos"+nb3("r5"));
	str += "</td> </tr>";
	str += "</table>";
	document.getElementById("templates").innerHTML = str;
	}

function start() {
	Upd();
	maketemplates();
	}
var veca = 2;
var vecb = 3;

function togglevector() {
	var a = Number(document.getElementById("a").value);
	var b = Number(document.getElementById("b").value);
	var c = Number(document.getElementById("c").value);
	var d = Number(document.getElementById("d").value);
	var vtog = document.getElementById("c7").checked;
	if (vtog == 0) {
		document.getElementById("w1").innerHTML = "";
		document.getElementById("w2").innerHTML = "";
		document.getElementById("w3").innerHTML = "";
		}
	if (vtog == 1) {
		document.getElementById("w1").innerHTML = makematrix(nb("v1",veca),"",nb("v2",vecb),"");
		document.getElementById("w2").innerHTML = "=";
		document.getElementById("w3").innerHTML = makematrix(veca*a+vecb*b,"",veca*c+vecb*d,"");
		}
	Upd();
	}

</script>
</head>
<body onload="start()">
Matrix Templates:
<p id="templates"> </p>
<table border = 0> <tr> <td>
<table border = 0>
<tr> <td rowspan=2 style="border-left:1px solid; border-top:1px solid; border-bottom:1px solid"> </td> <td> <input type ="number" id="a" value="1" oninput="Upd()" style="width: 4em"> </td> <td> <input type ="number" id="b" value="0" oninput="Upd()" style="width: 4em"> </td> <td rowspan=2 style="border-right:1px solid; border-top:1px solid; border-bottom:1px solid"> </td> </tr> 
<tr> <td> <input type ="number" id="c" value="0" oninput="Upd()" style="width: 4em"> </td> <td> <input type ="number" id="d" value="1" oninput="Upd()" style="width: 4em"> </td> </table> </td>
<td> <div id="w1"> </div> </td>
<td> <div id="w2"> </div> </td>
<td> <div id="w3"> </div> </td>
</tr> </table>
<button onclick="morph()"> Morph</button><br>
<canvas id="canv" width=500 height=500 style="border:1px solid #c3c3c3;"> </canvas>
<table>
<tr> <td> Min x: <input type="number" id="plotminx" oninput="Upd()" value = -5 style="width:3em"> </td>
<td> Max x: <input type="number" id="plotmaxx" oninput="Upd()" value = 5 style="width:3em"> </td>
</tr><tr>
<td> Min y: <input type="number" id="plotminy" oninput="Upd()" value = -5 style="width:3em"> </td>
<td> Max y: <input type="number" id="plotmaxy" oninput="Upd()" value = 5 style="width:3em"> </td>
</tr>
</table>
<input type="checkbox" id="c1" onchange="Upd()" checked> Show original axes <br>
<input type="checkbox" id="c2" onchange="Upd()" checked> Show original grid <br>
<input type="checkbox" id="c3" onchange="Upd()" checked> Show transformed axes <br>
<input type="checkbox" id="c4" onchange="Upd()" checked> Show transformed grid <br>
<input type="checkbox" id="c5" onchange="Upd()"> Show unit parallelogram <br>
<input type="checkbox" id="c6" onchange="Upd()"> Show unit sheep <br>
<input type="checkbox" id="c7" onchange="togglevector()"> Show arbitrary vector <br>
<img id="sheep" src="sheep.jpg" title="Original image by Natural Resources Conservation Service [Public domain], via Wikimedia Commons [https://commons.wikimedia.org/wiki/File:Sheep_and_goats.jpg]">
</body>
</html>